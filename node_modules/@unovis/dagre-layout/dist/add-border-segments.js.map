{"version":3,"file":"add-border-segments.js","sources":["../lib/add-border-segments.js"],"sourcesContent":["import _has from 'lodash-es/has'\nimport _forEach from 'lodash-es/forEach'\nimport util from './util'\n\nfunction addBorderSegments (g) {\n  function dfs (v) {\n    const children = g.children(v)\n    const node = g.node(v)\n\n    if (children.length) {\n      _forEach(children, dfs)\n    }\n\n    if (_has(node, 'minRank')) {\n      node.borderLeft = []\n      node.borderRight = []\n\n      for (let rank = node.minRank, maxRank = node.maxRank + 1; rank < maxRank; ++rank) {\n        addBorderNode(g, 'borderLeft', '_bl', v, node, rank)\n        addBorderNode(g, 'borderRight', '_br', v, node, rank)\n      }\n    }\n  }\n\n  _forEach(g.children(), dfs)\n}\n\nfunction addBorderNode (g, prop, prefix, sg, sgNode, rank) {\n  const label = {\n    width: 0,\n    height: 0,\n    rank: rank,\n    borderType: prop\n  }\n  const prev = sgNode[prop][rank - 1]\n  const curr = util.addDummyNode(g, 'border', label, prefix)\n  sgNode[prop][rank] = curr\n  g.setParent(curr, sg)\n\n  if (prev) {\n    g.setEdge(prev, curr, {\n      weight: 1\n    })\n  }\n}\n\nexport default addBorderSegments\n"],"names":[],"mappings":";;;;AAIA,SAAS,iBAAiB,EAAE,CAAC,EAAE;AAC/B,EAAE,SAAS,GAAG,EAAE,CAAC,EAAE;AACnB,IAAI,MAAM,QAAQ,GAAG,CAAC,CAAC,QAAQ,CAAC,CAAC,EAAC;AAClC,IAAI,MAAM,IAAI,GAAG,CAAC,CAAC,IAAI,CAAC,CAAC,EAAC;AAC1B;AACA,IAAI,IAAI,QAAQ,CAAC,MAAM,EAAE;AACzB,MAAM,QAAQ,CAAC,QAAQ,EAAE,GAAG,EAAC;AAC7B,KAAK;AACL;AACA,IAAI,IAAI,IAAI,CAAC,IAAI,EAAE,SAAS,CAAC,EAAE;AAC/B,MAAM,IAAI,CAAC,UAAU,GAAG,GAAE;AAC1B,MAAM,IAAI,CAAC,WAAW,GAAG,GAAE;AAC3B;AACA,MAAM,KAAK,IAAI,IAAI,GAAG,IAAI,CAAC,OAAO,EAAE,OAAO,GAAG,IAAI,CAAC,OAAO,GAAG,CAAC,EAAE,IAAI,GAAG,OAAO,EAAE,EAAE,IAAI,EAAE;AACxF,QAAQ,aAAa,CAAC,CAAC,EAAE,YAAY,EAAE,KAAK,EAAE,CAAC,EAAE,IAAI,EAAE,IAAI,EAAC;AAC5D,QAAQ,aAAa,CAAC,CAAC,EAAE,aAAa,EAAE,KAAK,EAAE,CAAC,EAAE,IAAI,EAAE,IAAI,EAAC;AAC7D,OAAO;AACP,KAAK;AACL,GAAG;AACH;AACA,EAAE,QAAQ,CAAC,CAAC,CAAC,QAAQ,EAAE,EAAE,GAAG,EAAC;AAC7B,CAAC;AACD;AACA,SAAS,aAAa,EAAE,CAAC,EAAE,IAAI,EAAE,MAAM,EAAE,EAAE,EAAE,MAAM,EAAE,IAAI,EAAE;AAC3D,EAAE,MAAM,KAAK,GAAG;AAChB,IAAI,KAAK,EAAE,CAAC;AACZ,IAAI,MAAM,EAAE,CAAC;AACb,IAAI,IAAI,EAAE,IAAI;AACd,IAAI,UAAU,EAAE,IAAI;AACpB,IAAG;AACH,EAAE,MAAM,IAAI,GAAG,MAAM,CAAC,IAAI,CAAC,CAAC,IAAI,GAAG,CAAC,EAAC;AACrC,EAAE,MAAM,IAAI,GAAG,IAAI,CAAC,YAAY,CAAC,CAAC,EAAE,QAAQ,EAAE,KAAK,EAAE,MAAM,EAAC;AAC5D,EAAE,MAAM,CAAC,IAAI,CAAC,CAAC,IAAI,CAAC,GAAG,KAAI;AAC3B,EAAE,CAAC,CAAC,SAAS,CAAC,IAAI,EAAE,EAAE,EAAC;AACvB;AACA,EAAE,IAAI,IAAI,EAAE;AACZ,IAAI,CAAC,CAAC,OAAO,CAAC,IAAI,EAAE,IAAI,EAAE;AAC1B,MAAM,MAAM,EAAE,CAAC;AACf,KAAK,EAAC;AACN,GAAG;AACH;;;;"}