{"version":3,"file":"dijkstra.js","sources":["../../lib/alg/dijkstra.js"],"sourcesContent":["import _constant from 'lodash-es/constant'\nimport PriorityQueue from '../data/priority-queue'\nexport default dijkstra\n\nvar DEFAULT_WEIGHT_FUNC = _constant(1)\n\nfunction dijkstra (g, source, weightFn, edgeFn) {\n  return runDijkstra(g, String(source), weightFn || DEFAULT_WEIGHT_FUNC, edgeFn || function (v) {\n    return g.outEdges(v)\n  })\n}\n\nfunction runDijkstra (g, source, weightFn, edgeFn) {\n  const results = {}\n  const pq = new PriorityQueue()\n  let v, vEntry\n\n  var updateNeighbors = function (edge) {\n    const w = edge.v !== v ? edge.v : edge.w\n    const wEntry = results[w]\n    const weight = weightFn(edge)\n    const distance = vEntry.distance + weight\n\n    if (weight < 0) {\n      throw new Error('dijkstra does not allow negative edge weights. ' + 'Bad edge: ' + edge + ' Weight: ' + weight)\n    }\n\n    if (distance < wEntry.distance) {\n      wEntry.distance = distance\n      wEntry.predecessor = v\n      pq.decrease(w, distance)\n    }\n  }\n\n  g.nodes().forEach(function (v) {\n    var distance = v === source ? 0 : Number.POSITIVE_INFINITY\n    results[v] = {\n      distance: distance\n    }\n    pq.add(v, distance)\n  })\n\n  while (pq.size() > 0) {\n    v = pq.removeMin()\n    vEntry = results[v]\n\n    if (vEntry.distance === Number.POSITIVE_INFINITY) {\n      break\n    }\n\n    edgeFn(v).forEach(updateNeighbors)\n  }\n\n  return results\n}\n"],"names":[],"mappings":";;;AAIA,IAAI,mBAAmB,GAAG,SAAS,CAAC,CAAC,EAAC;AACtC;AACA,SAAS,QAAQ,EAAE,CAAC,EAAE,MAAM,EAAE,QAAQ,EAAE,MAAM,EAAE;AAChD,EAAE,OAAO,WAAW,CAAC,CAAC,EAAE,MAAM,CAAC,MAAM,CAAC,EAAE,QAAQ,IAAI,mBAAmB,EAAE,MAAM,IAAI,UAAU,CAAC,EAAE;AAChG,IAAI,OAAO,CAAC,CAAC,QAAQ,CAAC,CAAC,CAAC;AACxB,GAAG,CAAC;AACJ,CAAC;AACD;AACA,SAAS,WAAW,EAAE,CAAC,EAAE,MAAM,EAAE,QAAQ,EAAE,MAAM,EAAE;AACnD,EAAE,MAAM,OAAO,GAAG,GAAE;AACpB,EAAE,MAAM,EAAE,GAAG,IAAI,aAAa,GAAE;AAChC,EAAE,IAAI,CAAC,EAAE,OAAM;AACf;AACA,EAAE,IAAI,eAAe,GAAG,UAAU,IAAI,EAAE;AACxC,IAAI,MAAM,CAAC,GAAG,IAAI,CAAC,CAAC,KAAK,CAAC,GAAG,IAAI,CAAC,CAAC,GAAG,IAAI,CAAC,EAAC;AAC5C,IAAI,MAAM,MAAM,GAAG,OAAO,CAAC,CAAC,EAAC;AAC7B,IAAI,MAAM,MAAM,GAAG,QAAQ,CAAC,IAAI,EAAC;AACjC,IAAI,MAAM,QAAQ,GAAG,MAAM,CAAC,QAAQ,GAAG,OAAM;AAC7C;AACA,IAAI,IAAI,MAAM,GAAG,CAAC,EAAE;AACpB,MAAM,MAAM,IAAI,KAAK,CAAC,iDAAiD,GAAG,YAAY,GAAG,IAAI,GAAG,WAAW,GAAG,MAAM,CAAC;AACrH,KAAK;AACL;AACA,IAAI,IAAI,QAAQ,GAAG,MAAM,CAAC,QAAQ,EAAE;AACpC,MAAM,MAAM,CAAC,QAAQ,GAAG,SAAQ;AAChC,MAAM,MAAM,CAAC,WAAW,GAAG,EAAC;AAC5B,MAAM,EAAE,CAAC,QAAQ,CAAC,CAAC,EAAE,QAAQ,EAAC;AAC9B,KAAK;AACL,IAAG;AACH;AACA,EAAE,CAAC,CAAC,KAAK,EAAE,CAAC,OAAO,CAAC,UAAU,CAAC,EAAE;AACjC,IAAI,IAAI,QAAQ,GAAG,CAAC,KAAK,MAAM,GAAG,CAAC,GAAG,MAAM,CAAC,kBAAiB;AAC9D,IAAI,OAAO,CAAC,CAAC,CAAC,GAAG;AACjB,MAAM,QAAQ,EAAE,QAAQ;AACxB,MAAK;AACL,IAAI,EAAE,CAAC,GAAG,CAAC,CAAC,EAAE,QAAQ,EAAC;AACvB,GAAG,EAAC;AACJ;AACA,EAAE,OAAO,EAAE,CAAC,IAAI,EAAE,GAAG,CAAC,EAAE;AACxB,IAAI,CAAC,GAAG,EAAE,CAAC,SAAS,GAAE;AACtB,IAAI,MAAM,GAAG,OAAO,CAAC,CAAC,EAAC;AACvB;AACA,IAAI,IAAI,MAAM,CAAC,QAAQ,KAAK,MAAM,CAAC,iBAAiB,EAAE;AACtD,MAAM,KAAK;AACX,KAAK;AACL;AACA,IAAI,MAAM,CAAC,CAAC,CAAC,CAAC,OAAO,CAAC,eAAe,EAAC;AACtC,GAAG;AACH;AACA,EAAE,OAAO,OAAO;AAChB;;;;"}